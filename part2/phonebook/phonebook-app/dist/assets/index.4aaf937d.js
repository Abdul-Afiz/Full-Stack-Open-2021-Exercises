var k=Object.defineProperty,P=Object.defineProperties;var E=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var S=(e,t,n)=>t in e?k(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,u=(e,t)=>{for(var n in t||(t={}))O.call(t,n)&&S(e,n,t[n]);if(D)for(var n of D(t))A.call(t,n)&&S(e,n,t[n]);return e},m=(e,t)=>P(e,E(t));import{j as C,a as y,r as p,R as F}from"./vendor.d54fab0c.js";const I=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))c(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&c(d)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerpolicy&&(r.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?r.credentials="include":o.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}};I();const s=C.exports.jsx,g=C.exports.jsxs,R=({value:e,keyvalue:t})=>g("div",{children:[s("span",{children:"filter shown with"})," ",s("input",{type:"text",value:e,onChange:t})]});function T({submit:e,value1:t,value2:n,keychange1:c,keychange2:o}){return g("form",{onSubmit:e,children:[g("div",{children:["name: ",s("input",{value:t,onChange:c})]}),s("br",{}),g("div",{children:["number: ",s("input",{value:n,onChange:o})]}),s("div",{children:s("button",{type:"submit",children:"add"})})]})}const w="/api/persons",U=()=>y.get(w).then(e=>e.data),B=e=>y.post(w,e).then(t=>t.data),M=(e,t)=>y.put(`${w}/${e}`,t).then(n=>n.data),q=e=>y.delete(`${w}/${e}`).then(t=>t.data);var x={getDatas:U,create:B,update:M,deleteData:q};const K=({onclick:e})=>s("button",{onClick:e,children:"Delete"}),z=({filterDisplay:e,setPersons:t,persons:n})=>{const c=r=>x.deleteData(r).then(d=>t(n.filter(N=>N.id!==r))),o=e.map((r,d)=>g("li",{children:[r.name," ",r.number," ",s(K,{onclick:()=>{window.confirm(`Delete ${r.name}`)&&c(r.id)}})]},r.id));return s("div",{children:o})},G=({message:e})=>e===null?null:s("div",{className:"Notifier",children:e}),H=({error:e})=>e===null?null:s("div",{className:"Errormsg",children:e});function J(){const[e,t]=p.exports.useState([]),[n,c]=p.exports.useState(""),[o,r]=p.exports.useState(""),[d,N]=p.exports.useState(""),[l,h]=p.exports.useState({success:"",error:""});p.exports.useEffect(()=>{x.getDatas().then(a=>t(a))},[]);const L=(a,v)=>{const f=m(u({},a),{number:v.number});x.update(a.id,f).then(i=>{console.log(i),t(e.map(b=>b.id!==a.id?b:i))}).catch(i=>{h(m(u({},l),{error:`Information of '${f.name.toUpperCase()}' has already been removed from the server`})),setTimeout(()=>{h(m(u({},l),{error:null}))},4e3),t(e.filter(b=>b.id!==a.id))})},$=a=>{a.preventDefault();const v={name:n,number:Number(o)},f=e.find(i=>i.name.toLowerCase()===n.toLowerCase());if(f){window.confirm(` ${f.name} is already added to phonebook, replace the old number with a new one`)&&L(f,v),c(""),r("");return}else x.create(v).then(i=>{t(e.concat(i)),h(m(u({},l),{success:`Added ${i.name.toUpperCase()}`})),setTimeout(()=>{h(m(u({},l),{success:null}))},4e3),c(""),r("")}).catch(i=>{console.log(i.response.data.error),h(m(u({},l),{error:i.response.data.error})),setTimeout(()=>{h(m(u({},l),{error:null}))},4e3)})},j=e.filter(a=>a.name.toLowerCase().includes(d));return g("div",{children:[s("h2",{children:"Phonebook"}),l.success!==""?s(G,{message:l.success}):l.error!==""?s(H,{error:l.error}):null,s(R,{value:d,keyvalue:a=>{N(a.target.value)}}),s("h3",{children:"add a new"}),s(T,{submit:$,value1:n,value2:o,keychange1:a=>{c(a.target.value.trim())},keychange2:a=>{r(a.target.value.trim())}}),s("h3",{children:"Numbers"}),s("ul",{children:s(z,{filterDisplay:j,setPersons:t,persons:e})})]})}F.render(s(J,{}),document.getElementById("root"));
